<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Are The Tennis Courts Open? - Central Park</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .status-open {
            box-shadow: 0 0 20px rgba(74, 222, 128, 0.5);
        }
        .status-closed {
            box-shadow: 0 0 20px rgba(248, 113, 113, 0.5);
        }
        .weather-card {
            backdrop-filter: blur(10px);
            background-color: rgba(255, 255, 255, 0.8);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-green-50 to-blue-50">
    <div class="container mx-auto px-4 py-12">
        <header class="text-center mb-12">
            <h1 class="text-4xl md:text-5xl font-bold text-gray-800 mb-2">
                <i class="fas fa-table-tennis text-green-500 mr-2"></i>
                Are The Tennis Courts Open?
            </h1>
            <p class="text-lg text-gray-600">Central Park Tennis Courts Status</p>
        </header>

        <main class="max-w-3xl mx-auto">
            <!-- Current Status Card -->
            <div id="statusCard" class="bg-white rounded-xl p-8 mb-8 transition-all duration-500">
                <div class="flex flex-col md:flex-row items-center justify-between">
                    <div class="flex items-center mb-4 md:mb-0">
                        <div id="statusIcon" class="text-5xl mr-6">
                            <i class="fas fa-table-tennis"></i>
                        </div>
                        <div>
                            <h2 class="text-2xl font-semibold text-gray-800">Central Park Tennis Courts</h2>
                            <p class="text-gray-500">New York, NY</p>
                        </div>
                    </div>
                    <div class="text-center md:text-right">
                        <div id="statusText" class="text-3xl font-bold mb-1">Checking...</div>
                        <div id="statusSubtext" class="text-lg">Loading current status</div>
                    </div>
                </div>
            </div>

            <!-- Weather and Conditions -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="weather-card rounded-xl p-6 border border-gray-200">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-temperature-high text-3xl text-blue-500 mr-3"></i>
                        <div>
                            <h3 class="font-medium text-gray-700">Temperature</h3>
                            <div id="temp" class="text-2xl font-bold">--°F</div>
                        </div>
                    </div>
                </div>
                <div class="weather-card rounded-xl p-6 border border-gray-200">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-cloud-rain text-3xl text-blue-400 mr-3"></i>
                        <div>
                            <h3 class="font-medium text-gray-700">Precipitation</h3>
                            <div id="precip" class="text-2xl font-bold">--%</div>
                        </div>
                    </div>
                </div>
                <div class="weather-card rounded-xl p-6 border border-gray-200">
                    <div class="flex items-center mb-4">
                        <i class="fas fa-clock text-3xl text-purple-500 mr-3"></i>
                        <div>
                            <h3 class="font-medium text-gray-700">Hours</h3>
                            <div class="text-2xl font-bold">6AM - Dusk</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Additional Info -->
            <div class="bg-white rounded-xl p-6 mb-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Court Information</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="flex items-start">
                        <i class="fas fa-map-marker-alt text-green-500 mt-1 mr-3"></i>
                        <div>
                            <h4 class="font-medium text-gray-700">Location</h4>
                            <p class="text-gray-600">Central Park Tennis Center, 93rd & Central Park West</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <i class="fas fa-clipboard-list text-blue-500 mt-1 mr-3"></i>
                        <div>
                            <h4 class="font-medium text-gray-700">Conditions</h4>
                            <p id="conditions" class="text-gray-600">Loading...</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <i class="fas fa-calendar-day text-orange-500 mt-1 mr-3"></i>
                        <div>
                            <h4 class="font-medium text-gray-700">Last Updated</h4>
                            <p id="lastUpdated" class="text-gray-600">Just now</p>
                        </div>
                    </div>
                    <div class="flex items-start">
                        <i class="fas fa-phone text-purple-500 mt-1 mr-3"></i>
                        <div>
                            <h4 class="font-medium text-gray-700">Contact</h4>
                            <p class="text-gray-600">(212) 310-6600</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Map -->
            <div class="bg-white rounded-xl overflow-hidden">
                <iframe 
                    src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3020.5542!2d-73.9585!3d40.7851!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x89c2589a018588a3%3A0x74a1b9dff505c8f1!2sCentral%20Park%20Tennis%20Center!5e0!3m2!1sen!2sus!4v1689876543210!5m2!1sen!2sus" 
                    width="100%" 
                    height="300" 
                    style="border:0;" 
                    allowfullscreen="" 
                    loading="lazy" 
                    referrerpolicy="no-referrer-when-downgrade"
                    class="rounded-b-xl"
                ></iframe>
            </div>
        </main>

        <footer class="mt-16 text-center text-gray-500 text-sm">
            <p>Data updates every 5 minutes. Status is based on weather and park conditions.</p>
            <p class="mt-2">© 2023 Are The Courts Open? Not affiliated with NYC Parks.</p>
        </footer>
    </div>

    <script>
        // Fetch court status from backend API
        async function fetchCourtStatus() {
            try {
                const response = await fetch('/api/status');
                if (!response.ok) {
                    throw new Error('Failed to fetch status');
                }
                return await response.json();
            } catch (error) {
                console.error('Error fetching court status:', error);
                // Fallback to demo data if backend is not available
                const now = new Date();
                const isOpenHours = now.getHours() >= 6 && now.getHours() < 20;
                const temp = Math.floor(Math.random() * 30) + 50;
                const isRaining = Math.random() > 0.7;
                
                return {
                    status: isOpenHours && !isRaining ? 'open' : 'closed',
                    temperature: temp,
                    precipitation: isRaining ? Math.floor(Math.random() * 50) + 30 : 0,
                    conditions: isRaining ? 'Wet courts' : 'Courts available for tennis',
                    lastUpdated: new Date().toLocaleTimeString(),
                    source: 'demo'
                };
            }
        }

        // Update the UI with the status
        async function updateStatus() {
            const statusData = await fetchCourtStatus();
            
            const statusCard = document.getElementById('statusCard');
            const statusIcon = document.getElementById('statusIcon');
            const statusText = document.getElementById('statusText');
            const statusSubtext = document.getElementById('statusSubtext');
            
            // Reset all status classes
            statusCard.classList.remove('status-open', 'status-closed', 'bg-green-50', 'bg-red-50', 'bg-yellow-50', 'bg-gray-100');
            
            switch (statusData.status) {
                case 'open':
                    statusCard.classList.add('status-open', 'bg-green-50');
                    statusIcon.innerHTML = '<i class="fas fa-check-circle text-green-500"></i>';
                    statusText.textContent = 'OPEN';
                    statusText.className = 'text-3xl font-bold mb-1 text-green-600';
                    statusSubtext.textContent = 'Tennis courts are available';
                    statusSubtext.className = 'text-lg text-green-700';
                    break;
                    
                case 'closed':
                    statusCard.classList.add('status-closed', 'bg-red-50');
                    statusIcon.innerHTML = '<i class="fas fa-times-circle text-red-500"></i>';
                    statusText.textContent = 'CLOSED';
                    statusText.className = 'text-3xl font-bold mb-1 text-red-600';
                    statusSubtext.textContent = 'Tennis courts are not available';
                    statusSubtext.className = 'text-lg text-red-700';
                    break;
                    
                case 'critically_open':
                    statusCard.classList.add('bg-yellow-50');
                    statusIcon.innerHTML = '<i class="fas fa-exclamation-triangle text-yellow-500"></i>';
                    statusText.textContent = 'CRITICALLY OPEN';
                    statusText.className = 'text-3xl font-bold mb-1 text-yellow-600';
                    statusSubtext.textContent = 'Emergency access only';
                    statusSubtext.className = 'text-lg text-yellow-700';
                    break;
                    
                case 'critically_closed':
                    statusCard.classList.add('bg-gray-100');
                    statusIcon.innerHTML = '<i class="fas fa-ban text-gray-500"></i>';
                    statusText.textContent = 'CRITICALLY CLOSED';
                    statusText.className = 'text-3xl font-bold mb-1 text-gray-600';
                    statusSubtext.textContent = 'Emergency closure - No access';
                    statusSubtext.className = 'text-lg text-gray-700';
                    break;
                    
                default:
                    statusCard.classList.add('bg-gray-100');
                    statusIcon.innerHTML = '<i class="fas fa-question-circle text-gray-500"></i>';
                    statusText.textContent = 'UNKNOWN';
                    statusText.className = 'text-3xl font-bold mb-1 text-gray-600';
                    statusSubtext.textContent = 'Status unavailable';
                    statusSubtext.className = 'text-lg text-gray-700';
            }
            
            document.getElementById('temp').textContent = `${statusData.temperature}°F`;
            document.getElementById('precip').textContent = `${statusData.precipitation}%`;
            document.getElementById('conditions').textContent = statusData.conditions;
            
            // Format the last updated time
            const lastUpdated = new Date(statusData.last_updated);
            document.getElementById('lastUpdated').textContent = lastUpdated.toLocaleString();
            
            // Add status source indicator if available
            if (statusData.source === 'demo') {
                const demoIndicator = document.createElement('div');
                demoIndicator.className = 'text-sm text-orange-600 mt-2';
                demoIndicator.textContent = '⚠️ Demo mode - Backend not connected';
                statusSubtext.parentNode.appendChild(demoIndicator);
            }
        }

        // Initial load
        updateStatus();
        
        // Update every 5 minutes
        setInterval(updateStatus, 5 * 60 * 1000);
        
        // Also update when tab becomes visible again
        document.addEventListener('visibilitychange', () => {
            if (!document.hidden) {
                updateStatus();
            }
        });
    </script>
</body>
</html>